% Created 2017-05-10 Wed 18:55
\documentclass{beamer}
\usepackage{fixltx2e}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{soul}
\usepackage{textcomp}
\usepackage{marvosym}
\usepackage{wasysym}
\usepackage{latexsym}
\usepackage{amssymb}
\usepackage{hyperref}
\tolerance=1000
\usepackage{etex}
\usepackage{amsmath}
\DeclareMathOperator*{\median}{median}
\usepackage{clrscode}
\usepackage{pstricks}
\usepackage{pgfplots}
\usepackage{tikz}
\usepackage[europeanresistors,americaninductors]{circuitikz}
\usepackage{colortbl}
\usepackage{yfonts}
\usetikzlibrary{shapes,arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows,shapes}
\usetikzlibrary{intersections}
\usetikzlibrary{calc,patterns,decorations.pathmorphing,decorations.markings}
\usepackage[BoldFont,SlantFont,CJKchecksingle]{xeCJK}
\setCJKmainfont[BoldFont=Evermore Hei]{Evermore Kai}
\setCJKmonofont{Evermore Kai}
\usepackage{pst-node}
\usepackage{pst-plot}
\psset{unit=5mm}
\usepackage{beamerarticle}
\mode<beamer>{\usetheme{Frankfurt}}
\mode<beamer>{\usecolortheme{dove}}
\mode<article>{\hypersetup{colorlinks=true,pdfborder={0 0 0}}}
\AtBeginSection[]{\begin{frame}<beamer>\frametitle{Topic}\tableofcontents[currentsection]\end{frame}}
\setbeamercovered{transparent}
\providecommand{\alert}[1]{\textbf{#1}}

\title{图像恢复}
\author{}
\date{}
\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={Emacs Org-mode version 7.9.3f}}

\begin{document}

\maketitle

\begin{frame}
\frametitle{Outline}
\setcounter{tocdepth}{3}
\tableofcontents
\end{frame}













\section{概述}
\label{sec-1}
\begin{frame}
\frametitle{图像退化与恢复}
\label{sec-1-1}

\begin{itemize}
\item 图像退化

    图像在形成、记录、处理和传输过程中，由于成像系统、记录设备、传输介质和处理方法的不完善，会导致图像质量下降。这一过程称为图像的退化。
\item 图像恢复
\begin{itemize}
\item 图像的恢复就是要尽可能恢复退化图像的本来面目，它是沿图像退化的逆过程进行。
\item 典型的图像恢复是根据图像退化的先验知识建立一个退化模型，以此模型为基础，采用各种逆退化处理方法进行恢复，使图像质量得到改善。
\end{itemize}
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{图像退化原因与形式}
\label{sec-1-2}

\begin{itemize}
\item 图像退化形式
\begin{itemize}
\item 模糊
\item 失真
\item 噪声
\end{itemize}
\item 图像退化原因
\begin{itemize}
\item 运动、对焦
\item 摄像机标定
\item 成像器件性能
\end{itemize}
\end{itemize}
\end{frame}
\section{图像退化与恢复模型}
\label{sec-2}
\begin{frame}
\frametitle{退化与恢复过程}
\label{sec-2-1}


\begin{itemize}
\item 退化过程可以被模型化为一个退化函数和一个加性噪声项，处理一幅输入图像 $f(x,y)$ 产生一幅退化图像 $g(x,y)$ 。
\item 给定 $g(x,y)$ 和关于退化函数H的一些知识以及外加噪声项 $n(x,y)$ ，图像复原的目的是获得关于原始图像的近似估计 $\hat f(x,y)$ 。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{退化模型}
\label{sec-2-2}


\[ g(x,y) = H[f(x,y)+n(x,y) \]
\end{frame}
\begin{frame}
\frametitle{线性退化模型}
\label{sec-2-3}


如果退化函数 $H$ 是一个线性、平移不变函数，那么在空间域中给出的退化图像可由下式给出：

\begin{align*}
g(x,y) &= h(x,y)\otimes f(x,y)+n(x,y)\\
G(u,v) &= H(u,v)F(u,v)+N(u,v)
\end{align*}
\end{frame}
\section{噪声模型}
\label{sec-3}
\begin{frame}
\frametitle{有噪声情况下的图像恢复}
\label{sec-3-1}

\begin{itemize}
\item 必须知道噪声的统计特性以及噪声和图像信号的相关情况，这是非常复杂的。在实际应用中，往往假设噪声是白噪声，即它的频谱密度为常数，且与图像不相关。
\item 不同的恢复技术需要不同的有关噪声的先验信息，（例如：维纳滤波器需要知道噪声的谱密度，约束反卷积法需要知道噪声的协方差）。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{噪声模型}
\label{sec-3-2}

\begin{itemize}
\item 数字图像的噪声主要来源于图像的获取和传输过程。图像传输器的工作情况受各种因素的影响，如图像获取中的环境条件和传感器件自身的质量
\item 存在的一些重要的噪声类型：高斯噪声、瑞利噪声、伽马噪声、指数分布噪声、均匀分布噪声、脉冲噪声等
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{噪声的空间和频率特性}
\label{sec-3-3}

\begin{itemize}
\item 假设噪声独立于空间坐标，并且它与图像本身无关联
\item 当噪声的傅里叶谱是常量时，噪声通常称为白噪声
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{高斯噪声(Gaussian noise)}
\label{sec-3-4}

\begin{itemize}
\item 概率密度函数（PDF)
\end{itemize}
\[p(z)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(z-\mu)^2}{2\sigma^2}}  \]
\end{frame}
\begin{frame}
\frametitle{瑞利噪声(Rayleigh noise)}
\label{sec-3-5}

\begin{itemize}
\item 概率密度函数（PDF)
\end{itemize}

\[
p(z)=
\begin{cases}
\frac{2}{b}(z-a)e^{-\frac{(z-a)^2}{b}},\qquad  x\geq a \\
0 ,\qquad x<a
\end{cases}
\]

\begin{itemize}
\item 均值与方差
   \begin{align*}
    \bar z &= a+\frac{\sqrt{\pi b}}{2} \\
    \sigma^2 &=  \frac{b(4-\pi)}{4}
   \end{align*}
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{爱尔朗（伽马）噪声(Erlang(Gamma) noise)}
\label{sec-3-6}

\begin{itemize}
\item 概率密度函数（PDF)
\end{itemize}
\[
p(z) = 
\begin{cases}
\frac{a^bz^{b-1}}{(b-1)!}e^{-az}, \qquad  z\geq 0 \\
0 , \qquad z<0
\end{cases}
 \]

\begin{itemize}
\item 均值与方差
   \begin{align*}
    \bar z &= \frac{b}{a} \\
    \sigma^2 &=  \frac{b}{a^2}
   \end{align*}
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{指数噪声(Exponential noise)}
\label{sec-3-7}

\begin{itemize}
\item 概率密度函数
\end{itemize}
\[ p(z) = 
\begin{cases}
a e^{-az}, \qquad z\geq 0 \\
0, \qquad z<0
\end{cases}
\]
\begin{itemize}
\item 均值与方差
\end{itemize}
\begin{align*}
    \bar z &= \frac{1}{a} \\
    \sigma^2 &=  \frac{1}{a^2}
\end{align*}
\end{frame}
\begin{frame}
\frametitle{均匀噪声(Uniform noise)}
\label{sec-3-8}

\begin{itemize}
\item 概率密度函数
\end{itemize}
\[ p(z) = 
\begin{cases}
\frac{1}{b-a}, \qquad a\leq z \leq b \\
0, \qquad \text{其它}
\end{cases}
\]
\begin{itemize}
\item 均值与方差
\end{itemize}
\begin{align*}
    \bar z &= \frac{a+b}{2} \\
    \sigma^2 &=  \frac{(b-a)^2}{12}
\end{align*}
\end{frame}
\begin{frame}
\frametitle{脉冲(椒盐)噪声(Impulse(salt and pepper) noise)}
\label{sec-3-9}

\begin{itemize}
\item 概率密度函数
\end{itemize}
\[ p(z) = 
\begin{cases}
p_a, \qquad z=a \\
p_b, \qquad z=b \\
0, \qquad \text{其它}
\end{cases}
\]
\end{frame}
\begin{frame}
\frametitle{周期噪声}
\label{sec-3-10}

\begin{itemize}
\item 图像获取过程中的电气、机电干扰
\item 可通过频域滤波减轻影响
\end{itemize}
\end{frame}
\section{噪声参数估计与滤波}
\label{sec-4}
\begin{frame}
\frametitle{周期噪声参数估计}
\label{sec-4-1}

\begin{itemize}
\item 通过检测图像的傅里叶谱进行估计。
\begin{itemize}
\item 直接从图像中推断噪声分量的周期性，但这仅仅在非常简单的情况下才是可能的。
\item 周期噪声通常会产生频率尖峰，这些尖峰通过视觉分析经常可以检侧到。
\end{itemize}
\item 当噪声尖峰格外显著或可以使用关于干扰的频率分量一般位置的某些知识时，自动分析是可能的。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{噪声存在下的唯一空间滤波恢复}
\label{sec-4-2}

\begin{align*}
g(x,y)&=f(x,y)+n(x,y)\\
G(u,v)&=F(u,v)+N(u,v)
\end{align*}

\begin{itemize}
\item 当仅有加性噪声存在时，可以选择空间滤波方法。
\item 均值滤波器
\item 顺序统计滤波器
\item 自适应滤波器
\end{itemize}
\end{frame}
\section{均值滤波器}
\label{sec-5}
\begin{frame}
\frametitle{均值滤波器}
\label{sec-5-1}

\begin{itemize}
\item 算术均值滤波器
\item 几何均值滤波器
\item 谐波均值滤波器
\item 逆谐波均值滤波器
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{算术均值滤波器}
\label{sec-5-2}

\begin{itemize}
\item 算术均值滤波器是最简单的均值滤波器。令 $S_{xy}$ 表示中心在 $(x,y)$ 点，尺寸为 $m\times n$ 的矩形子图像窗口的坐标组。
\end{itemize}
计算由 $S_{xy}$ 定义的区域中被干扰图像 $g(x,y)$ 的平均值。在任意点 $(x,y)$ 处复原图像就是用 $S_{xy}$ 定义区域的像素计算出来的算术均值。即：

\[ \hat f(x,y) = \frac{1}{mn}\sum_{(s,t)\in S_{xy}}g(s,t) \]
\end{frame}
\begin{frame}
\frametitle{几何均值滤波器}
\label{sec-5-3}


\[ \hat f(x,y) = \left[\prod_{(s,t)\in S_{xy}}g(s,t)\right]^{\frac{1}{mn}} \]

\begin{itemize}
\item 每个被复原像素等于子图像窗口中像素点乘积的 $\frac{1}{mn}$ 次幂。
\item 几何均值滤波器所达到的平滑度可以与算术均值滤波器相比，但在滤波过程中会丢失更少的图像细节。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{谐波均值滤波器}
\label{sec-5-4}

\begin{itemize}
\item 使用谐波均值滤波器的操作由如下表达式给出：
   \[ \hat f(x,y) = \frac{mn}{\sum_{(s,t)\in S_{xy}}\frac{1}{g(s,t)}} \]
\item 谐波均值滤波器对于“盐” 噪声效果较好，但不适于“胡椒”噪声。它善于处理高斯噪声。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{逆谐波均值滤波器}
\label{sec-5-5}

\begin{itemize}
\item 逆谐波均值滤波操作对一幅图像的复原基于表达式：
     \[ \hat f(x,y) = \frac{\sum_{(s,t)\in S_{xy}}g(s,t)^{Q+1}}{\sum_{(s,t)\in S_{xy}}g(s,t)^Q} \]
\item 其中Q称为滤波器的阶数。这种滤波器适合减少或是在实际中消除椒盐噪声的影响。
\begin{itemize}
\item 当Q值为正数时，滤波器用于消除“胡椒”噪声;
\item 当Q值为负数时，滤波器用于消除“盐”噪声。
\item 当Q=0时，逆谐波均值滤波器退变为算术均值滤波器;
\item 当Q=-1时，逆谐波均值滤波器退变为谐波均值滤波器。
\end{itemize}
\end{itemize}
\end{frame}
\section{统计排序滤波器}
\label{sec-6}
\begin{frame}
\frametitle{统计排序滤波器}
\label{sec-6-1}

统计滤波器是空间域滤波器，它们的响应基于由滤波器包围的图像区域中像素点的排序。滤波器在任何点的响应由排序结果决定。

\begin{itemize}
\item 中值滤波器
\item 最大值和最小值滤波器
\item 中点滤波器
\item 修正后的阿尔法均值滤波器
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{中值滤波器}
\label{sec-6-2}

\[  \hat f(x,y) = \median_{(s,t)\in S_{xy}} g(s,t) \]
\begin{itemize}
\item 中值滤波器的应用非常普遍，对于很多种随机噪声，它都有良好的去噪能力，
\item 在相同尺寸下比起线性平滑滤波器引起的模糊较少。
\item 中值滤波器尤其对单极或双极脉冲噪声非常有效。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{最大值滤波器}
\label{sec-6-3}

\[  \hat f(x,y) = \max_{(s,t)\in S_{xy}}g(s,t) \]
\begin{itemize}
\item 最大值滤波器在发现图像中的最亮点时非常有用。
\item 同样，因为“胡椒”噪声是非常低的值，作为子图像区域Sxy的最大值选择结果，它可以通过这种滤波器消除。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{最小值滤波器}
\label{sec-6-4}

\[  \hat f(x,y) = \min_{(s,t)\in S_{xy}}g(s,t) \]
\begin{itemize}
\item 对发现图像中的最暗点非常有用。
\item 作为最小值操作的结果，它可以用来消除“盐”噪声。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{中点滤波器}
\label{sec-6-5}

\[  \hat f(x,y) = \frac{1}{2}\left[\max_{(s,t)\in S_{xy}}g(s,t)+\frac{1}{2}\min_{(s,t)\in S_{xy}}g(s,t)\right] \]
\begin{itemize}
\item 结合了顺序统计和求平均，对于高斯和均匀随机分布这类噪声有最好的效果。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{修正后的阿尔法均值滤波器}
\label{sec-6-6}

在 $S_{xy}$ 邻域内去掉 $g(s,t)$ 最高灰度值的 $\frac{d}{2}$ 和最低灰度值的 $\frac{d}{2}$ 。用 $g_r(s,t)$ 来代表剩余的 $mn-d$ 个像素。
由这些剩余像素点的平均值形成的滤波器称为修正后的阿尔法均值滤波器。
\[ \hat f(x,y) = \frac{1}{mn-d}\sum_{(s,t)\in S_{xy}}g_r(s,t) \]
\begin{itemize}
\item 其中，$d$ 值可以取 $0$ 到 $mn-1$ 之间的任意数。
\item 修正后的阿尔法均值滤波器在包括多种噪声的情况下非常适用，例如高斯噪声和椒盐噪声混合的情况下。
\end{itemize}
\end{frame}
\section{自适应滤波器}
\label{sec-7}
\begin{frame}
\frametitle{自适应、局部噪声消除滤波器}
\label{sec-7-1}

\begin{itemize}
\item 随机变量最简单的统计度量是均值和方差。这些适当的参数是自适应滤波器的基础，因为它们是与图像状态紧密相关的数据。
\item 均值给出了计算均值的区域中灰度平均值的度量，
\item 方差给出了这个区域的平均对比度的度量。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{自适应、局部噪声消除滤波器}
\label{sec-7-2}

\[ \hat f(x,y)=g(x,y)-\frac{\sigma_n^2}{\sigma_L^2}(g(x,y)-m_L) \]

\begin{itemize}
\item $g(x,y)$ 表示图像在点 $(x,y)$ 上的值
\item $\sigma^2_n$ 表示干扰的方差
\item $m_L$ 表示 $S_{xy}$ 上像素点的局部均值
\item $\sigma_L^2$ 表示 $S_{xy}$ 上像素点的局部方差
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{自适应中值滤波器}
\label{sec-7-3}


\begin{itemize}
\item 自适应中值滤波器可以处理具有更大概率的冲激噪声。
\item 平滑非冲激噪声时可以更好地保存细节。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{自适应中值滤波器}
\label{sec-7-4}

如下标记符号：
\begin{itemize}
\item $z_{min}$ 表示 $S_{xy}$ 中灰度级的最小值
\item $z_{max}$ 表示 $S_{xy}$ 中灰度级的最大值
\item $z_{med}$ 表示 $S_{xy}$ 中灰度级的中值
\item $z_{xy}$ 表示坐标 $(x,y)$ 上的灰度级
\item $S_{max}$ 表示 $S_{xy}$ 允许的最大尺寸
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{自适应中值滤波器}
\label{sec-7-5}

 \begin{codebox}
\Procname{自适应中值滤波器}
 \zi      \Repeat
 \zi    $ A_1 \gets z_{med}-z_{min}$ 
 \zi    $ A_2 \gets z_{med}-z_{max}$ 
 \zi    \If  $A_1>0$ and  $A_2<0$ 
 \zi        \Then 
 \zi             $ B_1 \gets z_{xy}-z_{min}$ 
 \zi             $ B_2 \gets z_{xy}-z_{max}$ 
 \zi             \If  $B_1>0$ and  $ B_2<0$ 
 \zi               \Then \Return $z_{xy}$
 \zi               \Else \Return $z_{med}$
                 \End
 \zi        \Else increase the window-size
        \End  
 \zi \Until $window-size > S_{max}$ 
 \zi \Return $z_{med}$
 \end{codebox}
\end{frame}
\section{周期噪声滤波}
\label{sec-8}
\begin{frame}
\frametitle{周期噪声滤波}
\label{sec-8-1}

\begin{itemize}
\item 带阻滤波器
\item 带通滤波器
\item 陷波滤波器
\item 最佳陷波滤波器
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{带阻滤波器}
\label{sec-8-2}

\begin{itemize}
\item 带阻滤波器消除或衰减了傅里叶变换原点处的频段。
\item 带阻滤波器的主要应用之一是在频域噪声分量位置近似已知的应用中消除噪声。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{理想带阻滤波器}
\label{sec-8-3}

\[ H(u,v)=
\begin{cases}
1, \qquad D(u,v)<D_0-\frac{W}{2} \\
0, \qquad D_0-\frac{W}{2} \leq D(u,v) \leq D_0+\frac{W}{2}\\
1, \qquad D(u,v)>D_0+\frac{W}{2}
\end{cases}
\]

其中， $D(u,v)$ 是到中心化频率矩形原点的距离，$W$ 是频带的宽度， $D_0$ 是频带的中心半径。
\end{frame}
\begin{frame}
\frametitle{n阶巴特沃思(Butterworth)带阻滤波器}
\label{sec-8-4}

\[
H(u,v) = \frac{1}{1+\left(\frac{D(u,v)W}{D^2(u,v)-D_0^2}\right)^{2n}}
\]
\end{frame}
\begin{frame}
\frametitle{高斯带阻滤波器}
\label{sec-8-5}

\[
H(u,v)=1-e^{-\frac{1}{2}\left(\frac{D^2(u,v)-D_0^2}{D(u,v)W}\right)^{2n}}
\]
\end{frame}
\begin{frame}
\frametitle{带通滤波器}
\label{sec-8-6}

带通滤波器执行与带阻滤波器相反的操作。
带通滤波器的传递函数 $H_{bp}(u,v)$ 可由相应的带阻滤波器的传递函数 $H_{br}(u,v)$ 得到：
\[ H_{bp}(u,v)=1-H_{br}(u,v) \]
\end{frame}
\begin{frame}
\frametitle{理想带通滤波器}
\label{sec-8-7}

\[ H(u,v)=
\begin{cases}
0, \qquad D(u,v)<D_0-\frac{W}{2} \\
1, \qquad D_0-\frac{W}{2} \leq D(u,v) \leq D_0+\frac{W}{2}\\
0, \qquad D(u,v)>D_0+\frac{W}{2}
\end{cases}
\]
\end{frame}
\begin{frame}
\frametitle{理想Butterworth带通滤波器}
\label{sec-8-8}

\begin{align*}
H_{Bbp}(u,v) &=1- \frac{1}{1+\left(\frac{D(u,v)W}{D^2(u,v)-D_0^2}\right)^{2n}}\\
&= \frac{\left(\frac{D(u,v)W}{D^2(u,v)-D_0^2}\right)^{2n}}{1+\left(\frac{D(u,v)W}{D^2(u,v)-D_0^2}\right)^{2n}}
\end{align*}
\end{frame}
\begin{frame}
\frametitle{理想Gaussian带通滤波器}
\label{sec-8-9}

\begin{align*}
H(u,v)&=1-\left(1-e^{-\frac{1}{2}\left(\frac{D^2(u,v)-D_0^2}{D(u,v)W}\right)^{2n}}\right)\\
&=e^{-\frac{1}{2}\left(\frac{D^2(u,v)-D_0^2}{D(u,v)W}\right)^{2n}}
\end{align*}
\end{frame}
\begin{frame}
\frametitle{陷波滤波器}
\label{sec-8-10}

\begin{itemize}
\item 陷波滤波器阻止(或通过)事先定义的中心频率邻域内的频率。
\item 由于傅里叶变换是对称的，要获得有效结果，陷波滤波器必须以关于原点对称的形式出现。
\item 可实现的陷波滤波器的对数是任意的。陷波区域的形状也是任意的(例如，矩形)。
\end{itemize}
\end{frame}
\begin{frame}
\frametitle{理想陷波滤波器}
\label{sec-8-11}


\begin{align*}
H(u,v) &= \begin{cases}
0,\qquad D_1(u,v)\leq D_0  \\
0, \qquad D_2(u,v)\leq D_0 \\
1, \qquad \text{其它}
\end{cases}\\
D_1(u,v) &=\left((u-u_0)^2+(v-v_0)^2\right)^{\frac{1}{2}}\\
D_2(u,v) &=\left((u+u_0)^2+(v+v_0)^2\right)^{\frac{1}{2}}
\end{align*}

半径为 $D_0$ ，中心在 $(u_0，v_0)$ 且在 $(-u_0，-v_0)$ 对称
\end{frame}
\begin{frame}
\frametitle{阶数为n的巴特沃思陷波带阻滤波器}
\label{sec-8-12}

\[
H(u,v)=\frac{1}{1+\left(\frac{D_0^2}{D_1(u,v)D_2(u,v)}\right)^n}
\]
\end{frame}
\begin{frame}
\frametitle{高斯陷波带阻滤波器}
\label{sec-8-13}

\[
H(u,v)=1-e^{-\frac{1}{2}\frac{D_1(u,v)D_2(u,v)}{D_0^2}}
\]
\end{frame}
\begin{frame}
\frametitle{陷波带通滤波器的传递函数：}
\label{sec-8-14}

\[ 
H_{np}(u,v)=1-H_{nr}(u,v)
\]


当 $u_0=v_0$ 时， 陷波带通滤波器变为低通滤波器。
\end{frame}

\end{document}
